## SageMaker Model Monitoring의 제약조건 유형

SageMaker Model Monitoring은 다음과 같은 주요 제약조건 유형을 지원합니다:

### 1. 데이터 유형 제약조건
• **데이터 타입 일관성**: 각 특성(feature)의 데이터 타입이 기준 데이터셋과 일치하는지 확인
• **지원 타입**: numeric(숫자형), string(문자열), boolean(불리언) 등

### 2. 범주형 특성 제약조건
• **허용 값 목록**: 범주형 변수에 허용되는 값의 집합 정의
• **새로운 범주 감지**: 기준 데이터에 없던 새로운 범주 값 감지

### 3. 수치형 특성 제약조건
• **범위 제약조건**: 최소값, 최대값 범위 설정
• **분위수 제약조건**: 특정 분위수(예: 25%, 50%, 75%)에서의 값 범위
• **평균 및 표준편차**: 평균과 표준편차 기반 허용 범위

### 4. 결측값 제약조건
• **결측값 비율**: 허용 가능한 결측값의 최대 비율 설정
• **완전성 요구사항**: 특정 특성에 결측값이 없어야 하는 제약조건

### 5. 분포 기반 제약조건
• **KL 발산(Kullback-Leibler divergence)**: 기준 분포와 현재 데이터 분포 간의 차이 측정
• **Jensen-Shannon 거리**: 두 확률 분포 간의 유사성 측정
• **Wasserstein 거리**: 확률 분포 간의 거리 측정(Earth Mover's Distance라고도 함)

### 6. 상관관계 제약조건
• **특성 간 상관관계**: 특성 간의 상관관계가 기준 데이터셋과 유사한지 확인

### 7. 드리프트 감지 제약조건
• **통계적 드리프트 임계값**: p-값 기반 통계적 테스트를 통한 드리프트 감지
• **분포 변화 임계값**: 분포 변화의 허용 가능한 최대 정도 설정

## 제약조건 생성 및 관리 방법

1. 자동 생성: DefaultModelMonitor.suggest_baseline()을 사용하여 훈련 데이터셋에서 자동으로 제약조건 생성
  
python
   my_default_monitor.suggest_baseline(
       baseline_dataset=baseline_data_uri+'/training-dataset-with-header.csv',
       dataset_format=DatasetFormat.csv(header=True),
       output_s3_uri=baseline_results_uri,
       wait=True
   )
   


2. 수동 정의: JSON 형식으로 제약조건을 직접 정의하고 수정 가능
  
json
   {
     "features": [
       {
         "name": "feature_name",
         "type": "numeric",
         "min": 0,
         "max": 100,
         "mean": 50,
         "stddev": 10
       }
     ]
   }
   


3. 제약조건 커스터마이징: 사전 처리 및 사후 처리 스크립트를 사용하여 사용자 정의 제약조건 로직 구현

## 제약조건 위반 처리

1. 위반 감지: 모니터링 작업은 현재 데이터가 정의된 제약조건을 위반하는지 확인
2. 위반 보고서: 위반 사항은 JSON 형식으로 보고되며 위반된 제약조건, 실제 값, 예상 값 등 포함
3. CloudWatch 메트릭: 위반 사항은 CloudWatch 메트릭으로 게시되어 알림 설정 가능
4. 위반 심각도: 위반은 경고(warning)부터 오류(error)까지 다양한 심각도 수준으로 분류

## 실제 예시

노트북에서 생성된 제약조건의 예시:
• 수치형 특성에 대한 최소/최대 범위
• 범주형 특성에 대한 허용 값 목록
• 각 특성에 대한 결측값 비율 제한
• 특성 분포에 대한 통계적 제약조건

이러한 제약조건을 통해 모델이 프로덕션 환경에서 예상대로 작동하는지, 입력 데이터가 훈련 데이터와 일관성을 유지하는지 지속적으로 모니
터링할 수 있습니다.
